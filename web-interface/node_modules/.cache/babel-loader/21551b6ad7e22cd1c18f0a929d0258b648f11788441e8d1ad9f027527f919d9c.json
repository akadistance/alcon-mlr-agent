{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\josep\\\\OneDrive\\\\Documents\\\\Jason\\\\EyeQ MLR Agent\\\\alcon-mlr-agent\\\\web-interface\\\\src\\\\components\\\\InputArea.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useContext } from 'react';\nimport { Paperclip, X, Plus } from 'lucide-react';\nimport { ChatContext } from '../ChatContext';\nimport AddToChatPopover from './AddToChatPopover';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst InputArea = ({\n  onSendMessage,\n  isLoading,\n  hasMessages,\n  onStop,\n  sidebarCollapsed = false,\n  sidebarOpen = false,\n  isHomepage = false\n}) => {\n  _s();\n  const [message, setMessage] = useState('');\n  const [selectedFile, setSelectedFile] = useState(null);\n  const textareaRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const editorRef = useRef(null);\n  const addButtonRef = useRef(null);\n  const {\n    selectedTextContext,\n    clearSelectedTextContext\n  } = useContext(ChatContext);\n  const [isAddMenuOpen, setIsAddMenuOpen] = useState(false);\n  const [addMenuPosition, setAddMenuPosition] = useState({\n    x: 0,\n    y: 0\n  });\n\n  // Initialize contentEditable with placeholder on mount\n  useEffect(() => {\n    if (editorRef.current && !editorRef.current.textContent) {\n      const placeholderText = isHomepage ? 'What do you want to know?' : hasMessages ? 'Ask anything' : 'How can EyeQ help you today?';\n      editorRef.current.innerHTML = `<p data-placeholder=\"${placeholderText}\" class=\"placeholder\" style=\"line-height: 1.5; display: inline-block; vertical-align: middle;\"><br class=\"ProseMirror-trailingBreak\" /></p>`;\n    }\n  }, [hasMessages, isHomepage]);\n\n  // Prevent selection clearing from interfering with input focus\n  useEffect(() => {\n    const handleMouseDown = e => {\n      const target = e.target;\n      // If clicking on input area, prevent selection clearing\n      if (target.closest('#prompt-textarea') || target.closest('.ProseMirror') || target.closest('[data-type=\"text\"]')) {\n        e.stopPropagation();\n      }\n    };\n\n    // Use capture phase to catch events early\n    document.addEventListener('mousedown', handleMouseDown, true);\n    return () => {\n      document.removeEventListener('mousedown', handleMouseDown, true);\n    };\n  }, []);\n  const handleSubmit = e => {\n    e.preventDefault();\n    console.log('Submitting message:', message, 'File:', selectedFile);\n    if (!message.trim() && !selectedFile && !selectedTextContext || isLoading) return;\n\n    // Prepare attachments array if we have selected text context\n    const attachments = selectedTextContext ? [{\n      id: Date.now().toString(),\n      type: 'text',\n      title: 'Selected text',\n      content: selectedTextContext.text,\n      sourceMessageId: selectedTextContext.sourceMessageId\n    }] : undefined;\n\n    // Include selected text context in message if available\n    let messageToSend = message;\n    if (selectedTextContext) {\n      messageToSend = `[Context from previous message]\\n\"${selectedTextContext.text}\"\\n\\n[User question]\\n${message}`;\n      clearSelectedTextContext();\n    }\n\n    // Pass attachments to onSendMessage - we'll need to update the signature\n    onSendMessage(messageToSend, selectedFile, attachments);\n\n    // Clear state first\n    setMessage('');\n    setSelectedFile(null);\n    // Note: selectedTextContext is cleared in handleSubmit above\n\n    // Then reset editor to initial placeholder state after state flush\n    setTimeout(() => {\n      if (textareaRef.current) {\n        textareaRef.current.style.height = 'auto';\n      }\n      if (editorRef.current) {\n        const placeholderText = isHomepage ? 'What do you want to know?' : hasMessages ? 'Ask anything' : 'How can EyeQ help you today?';\n        editorRef.current.innerHTML = `<p data-placeholder=\"${placeholderText}\" class=\"placeholder\" style=\"line-height: 1.5; display: inline-block; vertical-align: middle;\"><br class=\"ProseMirror-trailingBreak\" /></p>`;\n      }\n    }, 0);\n  };\n  const handleEditorInput = () => {\n    if (!editorRef.current) return;\n    // Remove zero-width space and newlines\n    const text = editorRef.current.innerText.replace(/\\u200B/g, '').replace(/\\n$/, '');\n    setMessage(text);\n\n    // If user started typing over the placeholder, replace with plain text and set caret\n    const placeholder = editorRef.current.querySelector('.placeholder');\n    if (text && placeholder && placeholder.parentNode === editorRef.current) {\n      const textNode = document.createTextNode(text);\n      editorRef.current.innerHTML = '';\n      editorRef.current.appendChild(textNode);\n      const range = document.createRange();\n      const sel = window.getSelection();\n      range.setStart(editorRef.current.childNodes[0], text.length);\n      range.collapse(true);\n      sel === null || sel === void 0 ? void 0 : sel.removeAllRanges();\n      sel === null || sel === void 0 ? void 0 : sel.addRange(range);\n    }\n\n    // If emptied, restore placeholder\n    if (!text && !editorRef.current.querySelector('.placeholder')) {\n      const placeholderText = isHomepage ? 'What do you want to know?' : hasMessages ? 'Ask anything' : 'How can EyeQ help you today?';\n      editorRef.current.innerHTML = `<p data-placeholder=\"${placeholderText}\" class=\"placeholder\" style=\"line-height: 1.5; display: inline-block; vertical-align: middle;\"><br class=\"ProseMirror-trailingBreak\" /></p>`;\n    }\n  };\n  const handleEditorKeyDown = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSubmit(e);\n    }\n  };\n  const handleTextareaChange = e => {\n    console.log('Textarea change:', e.target.value);\n    setMessage(e.target.value);\n    const textarea = e.target;\n    textarea.style.height = 'auto';\n    textarea.style.height = Math.min(textarea.scrollHeight, 200) + 'px';\n  };\n  const handleFileSelect = e => {\n    var _e$target$files;\n    const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (file) {\n      const allowedTypes = ['text/plain', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/vnd.openxmlformats-officedocument.presentationml.presentation', 'application/pdf', 'image/jpeg', 'image/png', 'image/gif', 'image/webp', 'image/bmp'];\n      const maxSize = 10 * 1024 * 1024; // 10MB\n\n      if (!allowedTypes.includes(file.type)) {\n        alert('Please select a valid file type (.txt, .docx, .pptx, .pdf, or images for OCR)');\n        return;\n      }\n      if (file.size > maxSize) {\n        alert('File size must be less than 10MB');\n        return;\n      }\n      setSelectedFile(file);\n    }\n  };\n  const removeFile = () => {\n    setSelectedFile(null);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n  const canSend = (!!message.trim() || !!selectedFile) && !isLoading;\n\n  // Conditional layout classes for Claude-like transition\n  // On desktop (lg:), sidebar is static (w-16 or w-64) so we need matching left offset\n  // On mobile, sidebar is fixed, so we need left offset only when sidebar is open\n  const containerClass = hasMessages ? `fixed bottom-0 right-0 z-20 transition-all duration-300 ease-in-out ${\n  // Desktop: sidebar is static, always account for its width\n  // Mobile: only offset if sidebar is open\n  sidebarCollapsed ? sidebarOpen ? 'left-16 lg:left-16' // 64px when collapsed (both mobile when open and desktop)\n  : 'left-0 lg:left-16' // 0 on mobile when closed, 64px on desktop\n  : sidebarOpen ? 'left-64 lg:left-64' // 256px when expanded (both mobile when open and desktop)\n  : 'left-0 lg:left-64' // 0 on mobile when closed, 256px on desktop\n  }` : 'w-full transition-all duration-300 ease-in-out';\n  const wrapperClass = hasMessages ? 'w-full max-w-4xl mx-auto px-6 pb-4 transition-all duration-300 ease-in-out' : 'w-full max-w-4xl mx-auto px-6 transition-all duration-300 ease-in-out';\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: containerClass,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: wrapperClass,\n      children: [selectedFile && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-2 flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-2 rounded-lg bg-white dark:bg-gray-900\",\n            children: /*#__PURE__*/_jsxDEV(Paperclip, {\n              size: 14,\n              className: \"text-gray-500 dark:text-gray-400\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-sm font-medium text-gray-900 dark:text-gray-100\",\n              children: selectedFile.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs text-gray-500 dark:text-gray-400\",\n              children: [(selectedFile.size / 1024).toFixed(1), \" KB\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"p-1.5 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors\",\n          onClick: removeFile,\n          title: \"Remove file\",\n          \"aria-label\": \"Remove file\",\n          children: /*#__PURE__*/_jsxDEV(X, {\n            size: 16,\n            className: \"text-gray-500 dark:text-gray-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: \"group/composer w-full\",\n        \"data-type\": \"text\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `${isHomepage ? 'bg-white dark:bg-[#2a2a2a] min-h-[44px] py-2 px-3' : 'bg-white dark:bg-[#40414f] py-1.5 px-2 min-h-[40px]'} cursor-text overflow-hidden bg-clip-padding contain-inline-size grid grid-cols-[auto_1fr_auto] items-center [grid-template-areas:'header_header_header'_'leading_primary_trailing'_'._footer_.'] group-data-expanded/composer:[grid-template-areas:'header_header_header'_'primary_primary_primary'_'leading_footer_trailing'] shadow-[0_0_0_1px_rgba(0,0,0,0.05),0_2px_8px_rgba(0,0,0,0.1)] dark:shadow-[0_0_0_1px_rgba(255,255,255,0.05),0_2px_8px_rgba(0,0,0,0.3)] rounded-[24px] transition-all duration-200 ease-in-out focus-within:shadow-[0_0_0_3px_rgba(0,53,149,0.1),0_4px_12px_rgba(0,0,0,0.15)] dark:focus-within:shadow-[0_0_0_3px_rgba(0,53,149,0.2),0_4px_12px_rgba(0,0,0,0.4)]`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col overflow-x-hidden px-2 [grid-area:primary] group-data-expanded/composer:mb-0 group-data-expanded/composer:px-3 justify-center py-0\",\n            children: [selectedTextContext && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-start gap-2 px-2 py-2.5 w-full\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex-shrink-0 mt-0.5\",\n                  children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                    width: \"16\",\n                    height: \"16\",\n                    viewBox: \"0 0 20 20\",\n                    fill: \"none\",\n                    xmlns: \"http://www.w3.org/2000/svg\",\n                    className: \"text-token-text-secondary\",\n                    children: /*#__PURE__*/_jsxDEV(\"path\", {\n                      d: \"M2.94 2.94a1 1 0 0 1 1.02-.24l13.33 4.44a1 1 0 0 1 0 1.9L9.9 11.2a1 1 0 0 0-.7.7L7.04 17.29a1 1 0 0 1-1.9 0L.7 3.96a1 1 0 0 1 .24-1.02zm3.3 12.82l1.32-3.96a3 3 0 0 1 2.1-2.1l6.03-2-9.45-3.15 0 0 0 0L3.6 3.6l2.64 12.16z\",\n                      fill: \"currentColor\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 241,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 240,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 239,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex-1 min-w-0\",\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-sm text-token-text-primary dark:text-token-text-primary leading-relaxed break-words\",\n                    children: selectedTextContext.text\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 245,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 244,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  className: \"p-1 rounded-md hover:bg-token-surface-hover dark:hover:bg-token-surface-hover transition-colors flex-shrink-0 mt-0.5\",\n                  onClick: clearSelectedTextContext,\n                  title: \"Remove\",\n                  \"aria-label\": \"Remove attachment\",\n                  children: /*#__PURE__*/_jsxDEV(X, {\n                    size: 14,\n                    className: \"text-token-text-secondary dark:text-token-text-secondary\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 256,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 249,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-full h-px bg-token-border-subtle dark:bg-token-border-subtle mx-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `_prosemirror-parent_1dsxi_2 text-gray-900 dark:text-[#ececf1] max-h-[max(35svh,5rem)] max-h-52 flex-1 overflow-auto [scrollbar-width:thin] default-browser vertical-scroll-fade-mask flex items-center min-h-[20px] py-0 px-0 ${selectedTextContext ? 'pt-2' : ''}`,\n              children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                ref: textareaRef,\n                value: message,\n                onChange: handleTextareaChange,\n                placeholder: isHomepage ? 'What do you want to know?' : hasMessages ? 'Ask anything' : 'How can EyeQ help you today?',\n                className: \"sr-only\",\n                disabled: isLoading,\n                rows: 1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 266,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                ref: editorRef,\n                contentEditable: !isLoading,\n                translate: \"no\",\n                className: \"ProseMirror\",\n                id: \"prompt-textarea\",\n                \"data-virtualkeyboard\": \"true\",\n                suppressContentEditableWarning: true,\n                onInput: handleEditorInput,\n                onKeyDown: handleEditorKeyDown,\n                onClick: e => {\n                  // Ensure focus is maintained when clicking\n                  e.stopPropagation();\n                  if (editorRef.current) {\n                    editorRef.current.focus();\n                    // If empty, ensure cursor is visible by creating a text node\n                    if (!editorRef.current.textContent || editorRef.current.textContent.trim() === '') {\n                      // Remove placeholder and create empty text node for cursor\n                      const range = document.createRange();\n                      const sel = window.getSelection();\n                      editorRef.current.innerHTML = '';\n                      const textNode = document.createTextNode('\\u200B'); // Zero-width space\n                      editorRef.current.appendChild(textNode);\n                      range.setStart(textNode, 0);\n                      range.setEnd(textNode, 0);\n                      sel === null || sel === void 0 ? void 0 : sel.removeAllRanges();\n                      sel === null || sel === void 0 ? void 0 : sel.addRange(range);\n                    } else {\n                      // Restore cursor position at end if there's text\n                      const range = document.createRange();\n                      const sel = window.getSelection();\n                      if (sel && editorRef.current.childNodes.length > 0) {\n                        range.selectNodeContents(editorRef.current);\n                        range.collapse(false);\n                        sel.removeAllRanges();\n                        sel.addRange(range);\n                      }\n                    }\n                  }\n                },\n                onFocus: e => {\n                  // Ensure cursor is visible when focused\n                  e.stopPropagation();\n                  if (editorRef.current && (!editorRef.current.textContent || editorRef.current.textContent.trim() === '')) {\n                    // If empty when focused, create a zero-width space so cursor shows\n                    const range = document.createRange();\n                    const sel = window.getSelection();\n                    if (editorRef.current.innerHTML.includes('data-placeholder') || editorRef.current.textContent === '') {\n                      editorRef.current.innerHTML = '';\n                      const textNode = document.createTextNode('\\u200B'); // Zero-width space\n                      editorRef.current.appendChild(textNode);\n                      range.setStart(textNode, 0);\n                      range.setEnd(textNode, 0);\n                      sel === null || sel === void 0 ? void 0 : sel.removeAllRanges();\n                      sel === null || sel === void 0 ? void 0 : sel.addRange(range);\n                    }\n                  }\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 276,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-center gap-1 [grid-area:leading] pr-1 self-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              ref: addButtonRef,\n              type: \"button\",\n              className: \"flex items-center justify-center w-8 h-8 rounded-full bg-gray-100 dark:bg-[#2f2f2f] hover:bg-gray-200 dark:hover:bg-[#3a3a3a] transition-all duration-200 hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed\",\n              \"aria-label\": \"Add to chat\",\n              \"aria-haspopup\": \"menu\",\n              \"aria-expanded\": isAddMenuOpen,\n              onClick: () => {\n                if (addButtonRef.current) {\n                  const rect = addButtonRef.current.getBoundingClientRect();\n                  setAddMenuPosition({\n                    x: rect.left + rect.width / 2,\n                    y: rect.top\n                  });\n                  setIsAddMenuOpen(!isAddMenuOpen);\n                }\n              },\n              disabled: isLoading,\n              children: /*#__PURE__*/_jsxDEV(Plus, {\n                size: 18,\n                className: \"text-gray-600 dark:text-white\",\n                strokeWidth: 2.5\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 360,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 341,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"sr-only\",\n              onClick: () => {\n                var _fileInputRef$current;\n                return (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n              },\n              disabled: isLoading\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(AddToChatPopover, {\n            isOpen: isAddMenuOpen,\n            onClose: () => setIsAddMenuOpen(false),\n            onSelectFile: () => {\n              var _fileInputRef$current2;\n              (_fileInputRef$current2 = fileInputRef.current) === null || _fileInputRef$current2 === void 0 ? void 0 : _fileInputRef$current2.click();\n              setIsAddMenuOpen(false);\n            },\n            onSelectText: () => {\n              // If there's selected text context, it will show as pill\n              // Otherwise, this could trigger text selection mode\n              setIsAddMenuOpen(false);\n            },\n            position: addMenuPosition\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 373,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-center gap-2 [grid-area:trailing] pl-1 self-center\",\n            children: isLoading ? /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              \"aria-label\": \"Stop generation\",\n              title: \"Stop\",\n              className: \"flex h-8 w-8 items-center justify-center rounded-full bg-red-500 text-white transition-all duration-200 hover:bg-red-600 hover:scale-105 active:scale-95 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2 shadow-sm\",\n              onClick: () => onStop === null || onStop === void 0 ? void 0 : onStop(),\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                width: \"16\",\n                height: \"16\",\n                viewBox: \"0 0 20 20\",\n                fill: \"currentColor\",\n                xmlns: \"http://www.w3.org/2000/svg\",\n                children: /*#__PURE__*/_jsxDEV(\"rect\", {\n                  x: \"5\",\n                  y: \"5\",\n                  width: \"10\",\n                  height: \"10\",\n                  rx: \"1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 399,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 398,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              \"aria-label\": \"Send message\",\n              title: \"Send\",\n              disabled: !canSend,\n              className: `flex h-8 w-8 items-center justify-center transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 ${canSend ? 'rounded-full bg-[#003595] text-white hover:bg-[#1a4ba3] hover:scale-105 active:scale-95 focus-visible:ring-[#003595] shadow-sm' : 'rounded-lg bg-transparent text-gray-400 dark:text-[#8e8ea0] cursor-not-allowed opacity-40'}`,\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                width: \"16\",\n                height: \"16\",\n                viewBox: \"0 0 16 16\",\n                fill: \"none\",\n                xmlns: \"http://www.w3.org/2000/svg\",\n                className: canSend ? 'text-white' : 'text-gray-400 dark:text-[#8e8ea0]',\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"M.5 1.163A1 1 0 0 1 1.97.28l12.868 6.837a1 1 0 0 1 0 1.766L1.969 15.72A1 1 0 0 1 .5 14.836V10.33a1 1 0 0 1 .816-.983L8.5 8 1.316 6.653A1 1 0 0 1 .5 5.67V1.163Z\",\n                  fill: \"currentColor\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 415,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 414,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 403,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        ref: fileInputRef,\n        className: \"sr-only\",\n        tabIndex: -1,\n        \"aria-hidden\": \"true\",\n        id: \"upload-photos\",\n        accept: \".txt,.docx,.pptx,.pdf,.jpg,.jpeg,.png,.gif,.webp,.bmp\",\n        multiple: true,\n        type: \"file\",\n        onChange: handleFileSelect,\n        disabled: isLoading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"sr-only\",\n        tabIndex: -1,\n        \"aria-hidden\": \"true\",\n        id: \"upload-camera\",\n        accept: \"image/*\",\n        capture: \"environment\",\n        multiple: true,\n        type: \"file\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-token-text-secondary relative mt-1 flex min-h-6 w-full items-center justify-center p-1 text-center text-[10px] [view-transition-name:var(--vt-disclaimer)] md:px-[60px] transition-all duration-300 ease-in-out\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pointer-events-auto\",\n          children: \"EyeQ can make mistakes. Check important info.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 439,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 199,\n    columnNumber: 5\n  }, this);\n};\n_s(InputArea, \"vbVlMU1D1HL7zEtCi4tu+Ln4s1E=\");\n_c = InputArea;\nexport default InputArea;\nvar _c;\n$RefreshReg$(_c, \"InputArea\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useContext","Paperclip","X","Plus","ChatContext","AddToChatPopover","jsxDEV","_jsxDEV","Fragment","_Fragment","InputArea","onSendMessage","isLoading","hasMessages","onStop","sidebarCollapsed","sidebarOpen","isHomepage","_s","message","setMessage","selectedFile","setSelectedFile","textareaRef","fileInputRef","editorRef","addButtonRef","selectedTextContext","clearSelectedTextContext","isAddMenuOpen","setIsAddMenuOpen","addMenuPosition","setAddMenuPosition","x","y","current","textContent","placeholderText","innerHTML","handleMouseDown","e","target","closest","stopPropagation","document","addEventListener","removeEventListener","handleSubmit","preventDefault","console","log","trim","attachments","id","Date","now","toString","type","title","content","text","sourceMessageId","undefined","messageToSend","setTimeout","style","height","handleEditorInput","innerText","replace","placeholder","querySelector","parentNode","textNode","createTextNode","appendChild","range","createRange","sel","window","getSelection","setStart","childNodes","length","collapse","removeAllRanges","addRange","handleEditorKeyDown","key","shiftKey","handleTextareaChange","value","textarea","Math","min","scrollHeight","handleFileSelect","_e$target$files","file","files","allowedTypes","maxSize","includes","alert","size","removeFile","canSend","containerClass","wrapperClass","className","children","fileName","_jsxFileName","lineNumber","columnNumber","name","toFixed","onClick","onSubmit","width","viewBox","fill","xmlns","d","ref","onChange","disabled","rows","contentEditable","translate","suppressContentEditableWarning","onInput","onKeyDown","focus","setEnd","selectNodeContents","onFocus","rect","getBoundingClientRect","left","top","strokeWidth","_fileInputRef$current","click","isOpen","onClose","onSelectFile","_fileInputRef$current2","onSelectText","position","rx","tabIndex","accept","multiple","capture","_c","$RefreshReg$"],"sources":["C:/Users/josep/OneDrive/Documents/Jason/EyeQ MLR Agent/alcon-mlr-agent/web-interface/src/components/InputArea.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect, FormEvent, KeyboardEvent, ChangeEvent, useContext } from 'react';\r\nimport { Paperclip, X, Plus } from 'lucide-react';\r\nimport { ChatContext } from '../ChatContext';\r\nimport { Attachment } from '../types';\r\nimport AddToChatPopover from './AddToChatPopover';\r\n\r\ninterface InputAreaProps {\r\n  onSendMessage: (message: string, file?: File | null, attachments?: Attachment[]) => Promise<void>;\r\n  isLoading: boolean;\r\n  hasMessages: boolean;\r\n  onStop?: () => void;\r\n  sidebarCollapsed?: boolean;\r\n  sidebarOpen?: boolean;\r\n  isHomepage?: boolean;\r\n}\r\n\r\nconst InputArea: React.FC<InputAreaProps> = ({ onSendMessage, isLoading, hasMessages, onStop, sidebarCollapsed = false, sidebarOpen = false, isHomepage = false }) => {\r\n  const [message, setMessage] = useState('');\r\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\r\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const editorRef = useRef<HTMLDivElement>(null);\r\n  const addButtonRef = useRef<HTMLButtonElement>(null);\r\n  const { selectedTextContext, clearSelectedTextContext } = useContext(ChatContext);\r\n  const [isAddMenuOpen, setIsAddMenuOpen] = useState(false);\r\n  const [addMenuPosition, setAddMenuPosition] = useState({ x: 0, y: 0 });\r\n\r\n  // Initialize contentEditable with placeholder on mount\r\n  useEffect(() => {\r\n    if (editorRef.current && !editorRef.current.textContent) {\r\n      const placeholderText = isHomepage ? 'What do you want to know?' : (hasMessages ? 'Ask anything' : 'How can EyeQ help you today?');\r\n      editorRef.current.innerHTML = `<p data-placeholder=\"${placeholderText}\" class=\"placeholder\" style=\"line-height: 1.5; display: inline-block; vertical-align: middle;\"><br class=\"ProseMirror-trailingBreak\" /></p>`;\r\n    }\r\n  }, [hasMessages, isHomepage]);\r\n\r\n  // Prevent selection clearing from interfering with input focus\r\n  useEffect(() => {\r\n    const handleMouseDown = (e: MouseEvent) => {\r\n      const target = e.target as HTMLElement;\r\n      // If clicking on input area, prevent selection clearing\r\n      if (target.closest('#prompt-textarea') || \r\n          target.closest('.ProseMirror') || \r\n          target.closest('[data-type=\"text\"]')) {\r\n        e.stopPropagation();\r\n      }\r\n    };\r\n\r\n    // Use capture phase to catch events early\r\n    document.addEventListener('mousedown', handleMouseDown, true);\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleMouseDown, true);\r\n    };\r\n  }, []);\r\n\r\n  const handleSubmit = (e: FormEvent | KeyboardEvent) => {\r\n    e.preventDefault();\r\n    console.log('Submitting message:', message, 'File:', selectedFile);\r\n    if ((!message.trim() && !selectedFile && !selectedTextContext) || isLoading) return;\r\n\r\n    // Prepare attachments array if we have selected text context\r\n    const attachments = selectedTextContext ? [{\r\n      id: Date.now().toString(),\r\n      type: 'text' as const,\r\n      title: 'Selected text',\r\n      content: selectedTextContext.text,\r\n      sourceMessageId: selectedTextContext.sourceMessageId\r\n    }] : undefined;\r\n\r\n    // Include selected text context in message if available\r\n    let messageToSend = message;\r\n    if (selectedTextContext) {\r\n      messageToSend = `[Context from previous message]\\n\"${selectedTextContext.text}\"\\n\\n[User question]\\n${message}`;\r\n      clearSelectedTextContext();\r\n    }\r\n\r\n    // Pass attachments to onSendMessage - we'll need to update the signature\r\n    onSendMessage(messageToSend, selectedFile, attachments);\r\n\r\n    // Clear state first\r\n    setMessage('');\r\n    setSelectedFile(null);\r\n    // Note: selectedTextContext is cleared in handleSubmit above\r\n\r\n    // Then reset editor to initial placeholder state after state flush\r\n    setTimeout(() => {\r\n      if (textareaRef.current) {\r\n        textareaRef.current.style.height = 'auto';\r\n      }\r\n      if (editorRef.current) {\r\n        const placeholderText = isHomepage ? 'What do you want to know?' : (hasMessages ? 'Ask anything' : 'How can EyeQ help you today?');\r\n        editorRef.current.innerHTML = `<p data-placeholder=\"${placeholderText}\" class=\"placeholder\" style=\"line-height: 1.5; display: inline-block; vertical-align: middle;\"><br class=\"ProseMirror-trailingBreak\" /></p>`;\r\n      }\r\n    }, 0);\r\n  };\r\n\r\n  const handleEditorInput = () => {\r\n    if (!editorRef.current) return;\r\n    // Remove zero-width space and newlines\r\n    const text = editorRef.current.innerText.replace(/\\u200B/g, '').replace(/\\n$/, '');\r\n    setMessage(text);\r\n\r\n    // If user started typing over the placeholder, replace with plain text and set caret\r\n    const placeholder = editorRef.current.querySelector('.placeholder');\r\n    if (text && placeholder && placeholder.parentNode === editorRef.current) {\r\n      const textNode = document.createTextNode(text);\r\n      editorRef.current.innerHTML = '';\r\n      editorRef.current.appendChild(textNode);\r\n      const range = document.createRange();\r\n      const sel = window.getSelection();\r\n      range.setStart(editorRef.current.childNodes[0], text.length);\r\n      range.collapse(true);\r\n      sel?.removeAllRanges();\r\n      sel?.addRange(range);\r\n    }\r\n\r\n    // If emptied, restore placeholder\r\n    if (!text && !editorRef.current.querySelector('.placeholder')) {\r\n      const placeholderText = isHomepage ? 'What do you want to know?' : (hasMessages ? 'Ask anything' : 'How can EyeQ help you today?');\r\n      editorRef.current.innerHTML = `<p data-placeholder=\"${placeholderText}\" class=\"placeholder\" style=\"line-height: 1.5; display: inline-block; vertical-align: middle;\"><br class=\"ProseMirror-trailingBreak\" /></p>`;\r\n    }\r\n  };\r\n\r\n  const handleEditorKeyDown = (e: KeyboardEvent<HTMLDivElement>) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSubmit(e);\r\n    }\r\n  };\r\n\r\n  const handleTextareaChange = (e: ChangeEvent<HTMLTextAreaElement>) => {\r\n    console.log('Textarea change:', e.target.value);\r\n    setMessage(e.target.value);\r\n    const textarea = e.target;\r\n    textarea.style.height = 'auto';\r\n    textarea.style.height = Math.min(textarea.scrollHeight, 200) + 'px';\r\n  };\r\n\r\n  const handleFileSelect = (e: ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      const allowedTypes = [\r\n        'text/plain',\r\n        'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\r\n        'application/vnd.openxmlformats-officedocument.presentationml.presentation',\r\n        'application/pdf',\r\n        'image/jpeg',\r\n        'image/png',\r\n        'image/gif',\r\n        'image/webp',\r\n        'image/bmp'\r\n      ];\r\n      const maxSize = 10 * 1024 * 1024; // 10MB\r\n\r\n      if (!allowedTypes.includes(file.type)) {\r\n        alert('Please select a valid file type (.txt, .docx, .pptx, .pdf, or images for OCR)');\r\n        return;\r\n      }\r\n\r\n      if (file.size > maxSize) {\r\n        alert('File size must be less than 10MB');\r\n        return;\r\n      }\r\n\r\n      setSelectedFile(file);\r\n    }\r\n  };\r\n\r\n  const removeFile = () => {\r\n    setSelectedFile(null);\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = '';\r\n    }\r\n  };\r\n\r\n  const canSend = (!!message.trim() || !!selectedFile) && !isLoading;\r\n\r\n  // Conditional layout classes for Claude-like transition\r\n  // On desktop (lg:), sidebar is static (w-16 or w-64) so we need matching left offset\r\n  // On mobile, sidebar is fixed, so we need left offset only when sidebar is open\r\n  const containerClass = hasMessages\r\n    ? `fixed bottom-0 right-0 z-20 transition-all duration-300 ease-in-out ${\r\n        // Desktop: sidebar is static, always account for its width\r\n        // Mobile: only offset if sidebar is open\r\n        sidebarCollapsed \r\n          ? sidebarOpen\r\n            ? 'left-16 lg:left-16' // 64px when collapsed (both mobile when open and desktop)\r\n            : 'left-0 lg:left-16' // 0 on mobile when closed, 64px on desktop\r\n          : sidebarOpen\r\n            ? 'left-64 lg:left-64' // 256px when expanded (both mobile when open and desktop)\r\n            : 'left-0 lg:left-64' // 0 on mobile when closed, 256px on desktop\r\n      }`\r\n    : 'w-full transition-all duration-300 ease-in-out';\r\n\r\n  const wrapperClass = hasMessages\r\n    ? 'w-full max-w-4xl mx-auto px-6 pb-4 transition-all duration-300 ease-in-out'\r\n    : 'w-full max-w-4xl mx-auto px-6 transition-all duration-300 ease-in-out';\r\n\r\n  return (\r\n    <div className={containerClass}>\r\n      <div className={wrapperClass}>\r\n        {/* File attachment preview */}\r\n        {selectedFile && (\r\n          <div className=\"mb-2 flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"p-2 rounded-lg bg-white dark:bg-gray-900\">\r\n                <Paperclip size={14} className=\"text-gray-500 dark:text-gray-400\" />\r\n              </div>\r\n              <div className=\"flex flex-col\">\r\n                <span className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">\r\n                  {selectedFile.name}\r\n                </span>\r\n                <span className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                  {(selectedFile.size / 1024).toFixed(1)} KB\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <button\r\n              type=\"button\"\r\n              className=\"p-1.5 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors\"\r\n              onClick={removeFile}\r\n              title=\"Remove file\"\r\n              aria-label=\"Remove file\"\r\n            >\r\n              <X size={16} className=\"text-gray-500 dark:text-gray-400\" />\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Grok-style Input Box */}\r\n        <form onSubmit={handleSubmit} className=\"group/composer w-full\" data-type=\"text\">\r\n          <div className={`${isHomepage ? 'bg-white dark:bg-[#2a2a2a] min-h-[44px] py-2 px-3' : 'bg-white dark:bg-[#40414f] py-1.5 px-2 min-h-[40px]'} cursor-text overflow-hidden bg-clip-padding contain-inline-size grid grid-cols-[auto_1fr_auto] items-center [grid-template-areas:'header_header_header'_'leading_primary_trailing'_'._footer_.'] group-data-expanded/composer:[grid-template-areas:'header_header_header'_'primary_primary_primary'_'leading_footer_trailing'] shadow-[0_0_0_1px_rgba(0,0,0,0.05),0_2px_8px_rgba(0,0,0,0.1)] dark:shadow-[0_0_0_1px_rgba(255,255,255,0.05),0_2px_8px_rgba(0,0,0,0.3)] rounded-[24px] transition-all duration-200 ease-in-out focus-within:shadow-[0_0_0_3px_rgba(0,53,149,0.1),0_4px_12px_rgba(0,0,0,0.15)] dark:focus-within:shadow-[0_0_0_3px_rgba(0,53,149,0.2),0_4px_12px_rgba(0,0,0,0.4)]`}>\r\n            \r\n            {/* Primary Input Area */}\r\n            <div className=\"flex flex-col overflow-x-hidden px-2 [grid-area:primary] group-data-expanded/composer:mb-0 group-data-expanded/composer:px-3 justify-center py-0\">\r\n              {/* Referenced Text Section - Grok style with separator line */}\r\n              {selectedTextContext && (\r\n                <>\r\n                  <div className=\"flex items-start gap-2 px-2 py-2.5 w-full\">\r\n                    <div className=\"flex-shrink-0 mt-0.5\">\r\n                      <svg width=\"16\" height=\"16\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" className=\"text-token-text-secondary\">\r\n                        <path d=\"M2.94 2.94a1 1 0 0 1 1.02-.24l13.33 4.44a1 1 0 0 1 0 1.9L9.9 11.2a1 1 0 0 0-.7.7L7.04 17.29a1 1 0 0 1-1.9 0L.7 3.96a1 1 0 0 1 .24-1.02zm3.3 12.82l1.32-3.96a3 3 0 0 1 2.1-2.1l6.03-2-9.45-3.15 0 0 0 0L3.6 3.6l2.64 12.16z\" fill=\"currentColor\"></path>\r\n                      </svg>\r\n                    </div>\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <span className=\"text-sm text-token-text-primary dark:text-token-text-primary leading-relaxed break-words\">\r\n                        {selectedTextContext.text}\r\n                      </span>\r\n                    </div>\r\n                    <button\r\n                      type=\"button\"\r\n                      className=\"p-1 rounded-md hover:bg-token-surface-hover dark:hover:bg-token-surface-hover transition-colors flex-shrink-0 mt-0.5\"\r\n                      onClick={clearSelectedTextContext}\r\n                      title=\"Remove\"\r\n                      aria-label=\"Remove attachment\"\r\n                    >\r\n                      <X size={14} className=\"text-token-text-secondary dark:text-token-text-secondary\" />\r\n                    </button>\r\n                  </div>\r\n                  {/* Thin separator line */}\r\n                  <div className=\"w-full h-px bg-token-border-subtle dark:bg-token-border-subtle mx-2\"></div>\r\n                </>\r\n              )}\r\n              \r\n              <div className={`_prosemirror-parent_1dsxi_2 text-gray-900 dark:text-[#ececf1] max-h-[max(35svh,5rem)] max-h-52 flex-1 overflow-auto [scrollbar-width:thin] default-browser vertical-scroll-fade-mask flex items-center min-h-[20px] py-0 px-0 ${selectedTextContext ? 'pt-2' : ''}`}>\r\n                {/* Hidden textarea fallback to keep existing logic */}\r\n                <textarea\r\n                  ref={textareaRef}\r\n                  value={message}\r\n                  onChange={handleTextareaChange}\r\n                  placeholder={isHomepage ? 'What do you want to know?' : (hasMessages ? 'Ask anything' : 'How can EyeQ help you today?')}\r\n                  className=\"sr-only\"\r\n                  disabled={isLoading}\r\n                  rows={1}\r\n                />\r\n                {/* Visible ProseMirror-style contentEditable */}\r\n                <div\r\n                  ref={editorRef}\r\n                  contentEditable={!isLoading}\r\n                  translate=\"no\"\r\n                  className=\"ProseMirror\"\r\n                  id=\"prompt-textarea\"\r\n                  data-virtualkeyboard=\"true\"\r\n                  suppressContentEditableWarning\r\n                  onInput={handleEditorInput}\r\n                  onKeyDown={handleEditorKeyDown}\r\n                  onClick={(e) => {\r\n                    // Ensure focus is maintained when clicking\r\n                    e.stopPropagation();\r\n                    if (editorRef.current) {\r\n                      editorRef.current.focus();\r\n                      // If empty, ensure cursor is visible by creating a text node\r\n                      if (!editorRef.current.textContent || editorRef.current.textContent.trim() === '') {\r\n                        // Remove placeholder and create empty text node for cursor\r\n                        const range = document.createRange();\r\n                        const sel = window.getSelection();\r\n                        editorRef.current.innerHTML = '';\r\n                        const textNode = document.createTextNode('\\u200B'); // Zero-width space\r\n                        editorRef.current.appendChild(textNode);\r\n                        range.setStart(textNode, 0);\r\n                        range.setEnd(textNode, 0);\r\n                        sel?.removeAllRanges();\r\n                        sel?.addRange(range);\r\n                      } else {\r\n                        // Restore cursor position at end if there's text\r\n                        const range = document.createRange();\r\n                        const sel = window.getSelection();\r\n                        if (sel && editorRef.current.childNodes.length > 0) {\r\n                          range.selectNodeContents(editorRef.current);\r\n                          range.collapse(false);\r\n                          sel.removeAllRanges();\r\n                          sel.addRange(range);\r\n                        }\r\n                      }\r\n                    }\r\n                  }}\r\n                  onFocus={(e) => {\r\n                    // Ensure cursor is visible when focused\r\n                    e.stopPropagation();\r\n                    if (editorRef.current && (!editorRef.current.textContent || editorRef.current.textContent.trim() === '')) {\r\n                      // If empty when focused, create a zero-width space so cursor shows\r\n                      const range = document.createRange();\r\n                      const sel = window.getSelection();\r\n                      if (editorRef.current.innerHTML.includes('data-placeholder') || editorRef.current.textContent === '') {\r\n                        editorRef.current.innerHTML = '';\r\n                        const textNode = document.createTextNode('\\u200B'); // Zero-width space\r\n                        editorRef.current.appendChild(textNode);\r\n                        range.setStart(textNode, 0);\r\n                        range.setEnd(textNode, 0);\r\n                        sel?.removeAllRanges();\r\n                        sel?.addRange(range);\r\n                      }\r\n                    }\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Leading Section - Add Button and File Upload */}\r\n            <div className=\"flex items-center justify-center gap-1 [grid-area:leading] pr-1 self-center\">\r\n              {/* Circular Add Button */}\r\n              <button\r\n                ref={addButtonRef}\r\n                type=\"button\"\r\n                className=\"flex items-center justify-center w-8 h-8 rounded-full bg-gray-100 dark:bg-[#2f2f2f] hover:bg-gray-200 dark:hover:bg-[#3a3a3a] transition-all duration-200 hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                aria-label=\"Add to chat\"\r\n                aria-haspopup=\"menu\"\r\n                aria-expanded={isAddMenuOpen}\r\n                onClick={() => {\r\n                  if (addButtonRef.current) {\r\n                    const rect = addButtonRef.current.getBoundingClientRect();\r\n                    setAddMenuPosition({\r\n                      x: rect.left + rect.width / 2,\r\n                      y: rect.top\r\n                    });\r\n                    setIsAddMenuOpen(!isAddMenuOpen);\r\n                  }\r\n                }}\r\n                disabled={isLoading}\r\n              >\r\n                <Plus size={18} className=\"text-gray-600 dark:text-white\" strokeWidth={2.5} />\r\n              </button>\r\n              \r\n              {/* File Upload Button (hidden, triggered by Add menu) */}\r\n              <button\r\n                type=\"button\"\r\n                className=\"sr-only\"\r\n                onClick={() => fileInputRef.current?.click()}\r\n                disabled={isLoading}\r\n              />\r\n            </div>\r\n            \r\n            {/* Add to Chat Popover */}\r\n            <AddToChatPopover\r\n              isOpen={isAddMenuOpen}\r\n              onClose={() => setIsAddMenuOpen(false)}\r\n              onSelectFile={() => {\r\n                fileInputRef.current?.click();\r\n                setIsAddMenuOpen(false);\r\n              }}\r\n              onSelectText={() => {\r\n                // If there's selected text context, it will show as pill\r\n                // Otherwise, this could trigger text selection mode\r\n                setIsAddMenuOpen(false);\r\n              }}\r\n              position={addMenuPosition}\r\n            />\r\n            \r\n            {/* Trailing Section - Action Buttons - Grok style */}\r\n            <div className=\"flex items-center justify-center gap-2 [grid-area:trailing] pl-1 self-center\">\r\n              {isLoading ? (\r\n                <button\r\n                  type=\"button\"\r\n                  aria-label=\"Stop generation\"\r\n                  title=\"Stop\"\r\n                  className=\"flex h-8 w-8 items-center justify-center rounded-full bg-red-500 text-white transition-all duration-200 hover:bg-red-600 hover:scale-105 active:scale-95 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2 shadow-sm\"\r\n                  onClick={() => onStop?.()}\r\n                >\r\n                  <svg width=\"16\" height=\"16\" viewBox=\"0 0 20 20\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                    <rect x=\"5\" y=\"5\" width=\"10\" height=\"10\" rx=\"1\"></rect>\r\n                  </svg>\r\n                </button>\r\n              ) : (\r\n                <button\r\n                  type=\"submit\"\r\n                  aria-label=\"Send message\"\r\n                  title=\"Send\"\r\n                  disabled={!canSend}\r\n                  className={`flex h-8 w-8 items-center justify-center transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 ${\r\n                    canSend \r\n                      ? 'rounded-full bg-[#003595] text-white hover:bg-[#1a4ba3] hover:scale-105 active:scale-95 focus-visible:ring-[#003595] shadow-sm' \r\n                      : 'rounded-lg bg-transparent text-gray-400 dark:text-[#8e8ea0] cursor-not-allowed opacity-40'\r\n                  }`}\r\n                >\r\n                  <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" className={canSend ? 'text-white' : 'text-gray-400 dark:text-[#8e8ea0]'}>\r\n                    <path d=\"M.5 1.163A1 1 0 0 1 1.97.28l12.868 6.837a1 1 0 0 1 0 1.766L1.969 15.72A1 1 0 0 1 .5 14.836V10.33a1 1 0 0 1 .816-.983L8.5 8 1.316 6.653A1 1 0 0 1 .5 5.67V1.163Z\" fill=\"currentColor\"/>\r\n                  </svg>\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </form>\r\n\r\n        {/* Hidden File Inputs */}\r\n        <input\r\n          ref={fileInputRef}\r\n          className=\"sr-only\"\r\n          tabIndex={-1}\r\n          aria-hidden=\"true\"\r\n          id=\"upload-photos\"\r\n          accept=\".txt,.docx,.pptx,.pdf,.jpg,.jpeg,.png,.gif,.webp,.bmp\"\r\n          multiple\r\n          type=\"file\"\r\n          onChange={handleFileSelect}\r\n          disabled={isLoading}\r\n        />\r\n        <input className=\"sr-only\" tabIndex={-1} aria-hidden=\"true\" id=\"upload-camera\" accept=\"image/*\" capture=\"environment\" multiple type=\"file\" />\r\n\r\n        {/* Disclaimer Footer */}\r\n        <div className=\"text-token-text-secondary relative mt-1 flex min-h-6 w-full items-center justify-center p-1 text-center text-[10px] [view-transition-name:var(--vt-disclaimer)] md:px-[60px] transition-all duration-300 ease-in-out\">\r\n          <div className=\"pointer-events-auto\">EyeQ can make mistakes. Check important info.</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InputArea;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}